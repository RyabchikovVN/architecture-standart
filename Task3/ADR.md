### <a name="_b7urdng99y53">Цифровизации депозитного направления бизнеса</a>**Название задачи:** 
### <a name="_hjk0fkfyohdk">Рябчиков В.Н.</a>**Автор:**
### <a name="_uanumrh8zrui">06.04.2025</a>**Дата:**
### <a name="_3bfxc9a45514"></a>**Функциональные требования**

|**№**|**Действующие лица или системы**|**Use Case**|**Описание**|
|1| ИТ-команда (системы: Сайт) | Клиент заходит на сайт и ему отображается список доступных депозитов с актуальными ставками | На сайте для клиентов отображать список доступных депозитов с актуальными ставками |
|2| ИТ-команда, менеджеры кол-центра (системы: Сайт + кол-центр + АБС) | Клиент заходит на сайт и может подать заявку на депозит, оставив свой номер телефона и Ф.И.О. | На сайте клиент может подать заявку на депозит, оставив свой номер телефона и Ф.И.О. Введенная клиентом информация сохраняется в заявке, которая поступает в систему "кол-центр". Доступ к заявке в системе "кол-центр" должен быть у менеджера кол-центра. После идентификации клиента, данные по заявке (номер телефона и Ф. И. О.) должны поступить в АБС. Данные клиента хранятся в мастер-системе (АБС), другие системы должны использовать перс данные из АБС|
|3| ИТ-команда (системы: Интернет-банк + АБС) | Клиент заходит в интернет-банк и, указав счёт и сумму депозита, может подать заявку на открытие депозита. Клиенту необходимо подтвердить операцию, с помощью СМС-кода, отправленного на его номер телефона, по которому он авторизовывался в интернет-банке.| В интернет-банке клиент, указав счёт и сумму депозита, может подать заявку на открытие депозита. Операцию необходимо клиенту подтвердить с помощью СМС-кода, отправленного на его телефон, указанный в заявке и авторизованным с этим номером в интернет-банке|
|4| ИТ-команда, менеджеры бэк-офис депозитов/кредитов (системы: Интернет-банк + АБС) | Клиент заходит в интернет-банк и ему отображается список доступных депозитов с актуальными ставками и персонализированные ставки лично для него|В интернет-банке необходимо клиенту отображать список доступных депозитов с актуальными ставками и персонализированные ставки лично для него. Персонализированные ставки должны расчитываться, согласовываться и храниться в АБС. Реализовать в АБС хранение данных "Ставки по депозитам". С ними должны иметь возможность работать сотрудники как бэк-офиса депозитов, так и бэк-офиса кредитов. Загрузить в АБС ставки по депозитам из Excel файлов сотрудников. Реализовать в АБС текущий процесс согласования ставки по заявке. На этапе MVP предполагается, что заявку на открытие депозита обработает менеджер в бэк-офисе. Он подтвердит условия депозита в АБС банка. При этом клиент должен получить СМС-уведомления после подтверждения размера ставки и открытия депозита|
### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**
Опишите здесь нефункциональные требования и архитектурно-значимые требования.

|**№**|**Требование**|
|1|Все сервисы должны работать 24/7 и быть доступны в 99,9% случаев, поэтому лучше избежать прямой работы интернет-банка с API АБС в новом процессе|
|2|Отклик по всем операциям должен быть максимально быстрым и занимать миллисекунды|
|3|Предусмотреть равномерное горизонтальное масштабирование и распределение запросов между серверами, приложениями и ЦОД|
|4|Использовать базы данных MS SQL и Oracle|
|5|Чувствительная информация и данные необходимо защищать с помощью механизма шифрования трафика|
|6|Версия платформы интернет-банка несовместима с kafka|
|7|АБС может масштабироваться только вертикально из-за своей базы данных|
|8|Номера телефонов клиентов в системах должны дополнительно шифроваться/хешироваться/маскироваться|

### <a name="_qmphm5d6rvi3"></a>**Решение**
[Диаграмма контекста](https://github.com/RyabchikovVN/architecture-standart/blob/work/Task3/Standart_C4_L2.drawio)
[Диаграмма контейнеров](https://github.com/RyabchikovVN/architecture-standart/blob/work/Task3/Standart_C4_L3.drawio)
1. Требуется добавить Kafka в путь прохождения заявки от системы Call Center до АБС, ввиду ограничения "АБС может масштабироваться только вертикально из-за своей базы данных"
2. Из-за того, что аутентификация клиента проходит в АБС, что будет нагружать систему, требуется: 
- внедрить keycloak
- разделить базу данных АБС на реплики по CORS и направить аутентификацию клиента в реплику Read Only

### <a name="_bjrr7veeh80c"></a>**Альтернативы**
1. Можно развернуть новые технологии, но необходимо, чтобы они были совместимы с существующими платформами разработки
2. Сейчас в интернет-банке мало клиентов — даже если произойдёт сбой и интернет-банк не будет работать целый день, это не принесёт проблем. Фактически всё работает в одном ЦОД на одной группе серверов. У банка есть резервный ЦОД, в случае сбоя можно переключиться на него.
3. Если нужны очереди сообщений, то лучше использовать Kafka на перспективу

**Недостатки, ограничения, риски**

Подробно опишите здесь недостатки, ограничения и риски выбранного решения.
1. Команда АБС утверждает, что база данных системы уже перегружена. Онлайн-подача заявок на большое количество продуктов может поставить под угрозу работоспособность банка.
2. АБС может масштабироваться только вертикально из-за своей базы данных.
3. Сейчас в интернет-банке мало клиентов — даже если произойдёт сбой и интернет-банк не будет работать целый день, это не принесёт проблем. Фактически всё работает в одном ЦОД на одной группе серверов. У банка есть резервный ЦОД, в случае сбоя можно переключиться на него.